# 版本号更新指南

## 🎯 **为什么需要更新版本号？**

### **缓存机制原理**
- 浏览器会缓存CSS、JavaScript等静态文件
- 文件名相同的情况下，浏览器会使用缓存版本
- 添加版本号参数（如 `?v=1.0.2`）会强制浏览器重新下载文件

### **如果不更新版本号会怎样？**
- ❌ 用户看到的仍然是旧版本的样式和功能
- ❌ 即使您更新了代码，用户浏览器仍显示旧内容
- ❌ 需要用户手动清除缓存或使用无痕模式才能看到更新

## 🛠️ **自动化更新方案**

### **使用脚本自动更新（推荐）**

#### **1. 自动递增版本号**
```bash
./update_version.sh
```
- 自动将补丁版本号+1（如：1.0.1 → 1.0.2）
- 更新所有HTML文件中的CSS和JS版本号
- 更新_headers文件（如果有）

#### **2. 手动指定版本号**
```bash
./update_version.sh 2.0.0
```
- 手动设置特定版本号
- 适用于重大更新或版本发布

### **手动更新方法**

#### **1. 使用sed命令**
```bash
# 更新所有HTML文件中的版本号
sed -i '' 's/v=1.0.2/v=1.0.3/g' *.html
```

#### **2. 使用文本编辑器**
- 在VS Code中使用查找替换功能
- 查找：`v=1.0.2`
- 替换：`v=1.0.3`

## 📋 **完整工作流程**

### **每次更新代码时：**

1. **修改代码内容**
   ```bash
   # 编辑您的HTML、CSS、JS文件
   ```

2. **更新版本号**
   ```bash
   # 自动递增版本号
   ./update_version.sh
   
   # 或手动指定版本号
   ./update_version.sh 1.0.3
   ```

3. **验证更新**
   ```bash
   # 检查版本号是否正确更新
   grep -o 'v=1.0.3' *.html | wc -l
   # 应该返回26（13个文件 × 2个版本号位置）
   ```

4. **提交到GitHub**
   ```bash
   git add .
   git commit -m "Update to version 1.0.3"
   git push
   ```

5. **等待部署完成**
   - GitHub Pages通常需要1-5分钟
   - 可以在GitHub仓库的Actions标签查看部署状态

6. **测试更新**
   - 使用普通模式访问网站
   - 确认更新内容正确显示
   - 如果仍有缓存问题，使用强制刷新

## 🔍 **版本号规则**

### **语义化版本号（推荐）**
- **主版本号.次版本号.补丁版本号**
- 例如：`1.0.2`
  - `1` = 主版本号（重大更新）
  - `0` = 次版本号（功能更新）
  - `2` = 补丁版本号（小修复）

### **更新规则**
- **补丁版本**：修复bug、样式调整 → `1.0.2` → `1.0.3`
- **次版本**：新功能、内容更新 → `1.0.3` → `1.1.0`
- **主版本**：重大重构、品牌更新 → `1.1.0` → `2.0.0`

## ⚠️ **注意事项**

### **1. 版本号一致性**
- 确保所有HTML文件中的版本号一致
- CSS和JS文件的版本号应该相同

### **2. 测试验证**
- 更新后一定要测试网站功能
- 确认新版本正确加载

### **3. 备份重要版本**
- 重大更新前建议创建Git分支
- 保留重要版本的备份

## 🚀 **快速命令参考**

```bash
# 查看当前版本号
grep -o 'v=[0-9]\+\.[0-9]\+\.[0-9]\+' *.html | head -1

# 自动更新版本号
./update_version.sh

# 验证更新结果
grep -o 'v=1.0.3' *.html | wc -l

# 查看所有版本号位置
grep -n "v=1.0.3" *.html
```

## 📞 **常见问题**

### **Q: 忘记更新版本号怎么办？**
A: 用户可能看不到更新内容，需要：
1. 立即更新版本号
2. 重新部署
3. 通知用户清除缓存或使用强制刷新

### **Q: 版本号可以重复使用吗？**
A: 不推荐，可能导致缓存混乱。建议每次更新都使用新的版本号。

### **Q: 可以删除版本号吗？**
A: 可以，但会导致缓存问题。建议保留版本号机制。 