<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AITDK SEO Extension 专用测试页面</title>
  
  <!-- 扩展程序超强兼容性Meta标签 -->
  <meta name="extension-friendly" content="true">
  <meta name="seo-tools-compatible" content="true">
  <meta name="aitdk-seo-extension" content="enabled">
  <meta name="AITDK-SEO-Extension" content="enabled">
  <meta name="aitdk_seo_extension" content="enabled">
  <meta name="chrome-extension-compatible" content="true">
  <meta name="browser-extension-allowed" content="all">
  <meta name="aitdk" content="compatible">
  <meta name="seo-extension" content="ready">
  <meta name="extension-support" content="full">
  <meta name="aitdk-compatible" content="true">
  <meta name="seo-tools-ready" content="true">
  <meta name="content-security-policy" content="">
  <meta name="referrer" content="unsafe-url">
  
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    .status-ok { color: #28a745; }
    .status-error { color: #dc3545; }
    .code-block {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre-wrap;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #0056b3;
    }
    
    /* 超强扩展程序支持CSS */
    [id*="aitdk"],
    [class*="aitdk"],
    [id*="seo"],
    [class*="seo"],
    [data-aitdk],
    [data-seo-extension] {
      all: revert-layer !important;
      z-index: 2147483647 !important;
      position: relative !important;
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      pointer-events: auto !important;
      user-select: auto !important;
      transform: none !important;
      filter: none !important;
      backdrop-filter: none !important;
      clip: auto !important;
      clip-path: none !important;
      overflow: visible !important;
    }
    
    iframe[src*="chrome-extension://"],
    iframe[src*="moz-extension://"] {
      z-index: 2147483647 !important;
      position: relative !important;
      visibility: visible !important;
      opacity: 1 !important;
      pointer-events: auto !important;
    }
  </style>
</head>
<body>
  <h1>🔍 AITDK SEO Extension 专用测试页面</h1>
  
  <div class="test-section">
    <h2>📊 实时扩展程序状态检测</h2>
    <button onclick="runExtensionTest()">🔄 检测扩展程序状态</button>
    <div id="extension-status" class="code-block">等待检测...</div>
  </div>
  
  <div class="test-section">
    <h2>🎯 Meta标签验证</h2>
    <div id="meta-check" class="code-block">正在验证Meta标签...</div>
  </div>
  
  <div class="test-section">
    <h2>🌐 环境信息</h2>
    <div id="env-info" class="code-block">正在收集环境信息...</div>
  </div>
  
  <div class="test-section">
    <h2>📝 扩展程序测试内容</h2>
    <p>这是一段测试内容，AITDK SEO Extension应该能够分析这段文字。</p>
    <h3>测试标题</h3>
    <p>这里包含了一些关键词：SEO优化, 网站分析, 搜索引擎优化。</p>
    <ul>
      <li>测试列表项目 1</li>
      <li>测试列表项目 2</li>
      <li>测试列表项目 3</li>
    </ul>
  </div>
  
  <!-- 扩展程序标识元素 -->
  <div id="aitdk-seo-extension-marker" style="display: none;" data-extension-friendly="true" data-seo-tools-ready="true"></div>
  <div id="seo-tools-ready-marker" style="display: none;" data-extension-friendly="true" data-seo-tools-ready="true"></div>
  <div id="extension-friendly-marker" style="display: none;" data-extension-friendly="true" data-seo-tools-ready="true"></div>
  
  <script>
    // 扩展程序超强兼容性脚本
    console.log('🔍 AITDK SEO Extension 专用测试页面启动');
    
    // 设置全局兼容性标识
    window.extensionFriendly = true;
    window.seoToolsCompatible = true;
    window.AITDKSEOExtensionEnabled = true;
    window.chromeExtensionCompatible = true;
    window.extensionSafeMode = true;
    
    Object.defineProperty(window, 'AITDK_COMPATIBLE', {
      value: true,
      writable: false,
      enumerable: true,
      configurable: false
    });
    
    // 监听扩展程序消息
    window.addEventListener('message', function(event) {
      console.log('📨 收到扩展程序消息:', event);
      if (event.data && (event.data.type === 'AITDK_SEO_EXTENSION' || event.data.source === 'AITDK')) {
        console.log('✅ 检测到AITDK SEO Extension通信');
        document.getElementById('extension-status').innerHTML = '✅ 扩展程序通信正常！';
      }
    });
    
    // 扩展程序测试函数
    function runExtensionTest() {
      const status = document.getElementById('extension-status');
      status.innerHTML = '🔄 正在检测扩展程序...';
      
      setTimeout(() => {
        const result = {
          timestamp: new Date().toLocaleString(),
          windowProperties: {
            extensionFriendly: window.extensionFriendly,
            seoToolsCompatible: window.seoToolsCompatible,
            AITDKSEOExtensionEnabled: window.AITDKSEOExtensionEnabled,
            chromeExtensionCompatible: window.chromeExtensionCompatible,
            AITDK_COMPATIBLE: window.AITDK_COMPATIBLE
          },
          domElements: {
            extensionElements: document.querySelectorAll('[id*="aitdk"], [class*="aitdk"], [id*="seo"], [class*="seo"]').length,
            markers: document.querySelectorAll('[data-extension-friendly="true"]').length,
            iframes: document.querySelectorAll('iframe[src*="chrome-extension"]').length
          },
          pageInfo: {
            url: window.location.href,
            title: document.title,
            readyState: document.readyState
          }
        };
        
        status.innerHTML = '📊 扩展程序检测结果:\n' + JSON.stringify(result, null, 2);
      }, 1000);
    }
    
    // 页面加载完成后的检查
    document.addEventListener('DOMContentLoaded', function() {
      console.log('✅ 专用测试页面DOM加载完成');
      
      // 检查Meta标签
      const metaCheck = document.getElementById('meta-check');
      const metaTags = [
        'extension-friendly',
        'seo-tools-compatible', 
        'aitdk-seo-extension',
        'aitdk',
        'seo-extension'
      ];
      
      let metaResults = '📋 Meta标签检查结果:\n';
      metaTags.forEach(tag => {
        const element = document.querySelector(`meta[name="${tag}"]`);
        metaResults += `${tag}: ${element ? '✅ 存在' : '❌ 缺失'}\n`;
      });
      metaCheck.innerHTML = metaResults;
      
      // 环境信息
      const envInfo = document.getElementById('env-info');
      envInfo.innerHTML = `🌐 环境信息:
用户代理: ${navigator.userAgent}
当前URL: ${window.location.href}
页面标题: ${document.title}
页面状态: ${document.readyState}
时间戳: ${new Date().toISOString()}`;
      
      // 自动运行一次检测
      setTimeout(() => runExtensionTest(), 2000);
    });
    
    // 定期检查扩展程序状态
    setInterval(() => {
      const extensionElements = document.querySelectorAll('[id*="aitdk"], [class*="aitdk"], [id*="seo"], [class*="seo"]');
      if (extensionElements.length > 0) {
        console.log('🔍 检测到', extensionElements.length, '个扩展程序元素');
      }
    }, 5000);
    
    console.log('🚀 专用测试页面脚本加载完成');
  </script>
</body>
</html> 