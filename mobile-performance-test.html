<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>移动端性能测试 - Hide All</title>
  <meta name="description" content="移动端性能优化测试页面">
  
  <!-- 预加载关键资源 -->
  <link rel="preload" href="styles.css" as="style">
  <link rel="preload" href="main.js" as="script">
  
  <!-- 样式文件 -->
  <link rel="stylesheet" href="styles.css">
  
  <!-- 性能监控脚本 -->
  <script>
    // 性能监控
    const performanceMetrics = {
      startTime: performance.now(),
      loadTime: 0,
      domContentLoaded: 0,
      firstPaint: 0,
      firstContentfulPaint: 0
    };
    
    // 记录关键性能指标
    window.addEventListener('load', () => {
      performanceMetrics.loadTime = performance.now() - performanceMetrics.startTime;
      console.log('页面加载时间:', performanceMetrics.loadTime.toFixed(2) + 'ms');
    });
    
    document.addEventListener('DOMContentLoaded', () => {
      performanceMetrics.domContentLoaded = performance.now() - performanceMetrics.startTime;
      console.log('DOM内容加载时间:', performanceMetrics.domContentLoaded.toFixed(2) + 'ms');
    });
    
    // 监控首次绘制
    if ('PerformanceObserver' in window) {
      const paintObserver = new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          if (entry.name === 'first-paint') {
            performanceMetrics.firstPaint = entry.startTime;
            console.log('首次绘制时间:', performanceMetrics.firstPaint.toFixed(2) + 'ms');
          }
          if (entry.name === 'first-contentful-paint') {
            performanceMetrics.firstContentfulPaint = entry.startTime;
            console.log('首次内容绘制时间:', performanceMetrics.firstContentfulPaint.toFixed(2) + 'ms');
          }
        }
      });
      paintObserver.observe({ entryTypes: ['paint'] });
    }
  </script>
</head>
<body class="bg-gray-50">
  <!-- 性能指标显示 -->
  <div class="fixed top-4 right-4 bg-white p-4 rounded-lg shadow-lg z-50 text-sm">
    <h3 class="font-bold mb-2">性能指标</h3>
    <div id="metrics"></div>
  </div>

  <!-- 测试内容 -->
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-center mb-8">移动端性能测试</h1>
    
    <!-- 设备信息 -->
    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
      <h2 class="text-xl font-semibold mb-4">设备信息</h2>
      <div id="device-info" class="space-y-2 text-sm">
        <p><strong>屏幕宽度:</strong> <span id="screen-width"></span></p>
        <p><strong>设备类型:</strong> <span id="device-type"></span></p>
        <p><strong>用户代理:</strong> <span id="user-agent"></span></p>
      </div>
    </div>
    
    <!-- 优化状态 -->
    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
      <h2 class="text-xl font-semibold mb-4">优化状态</h2>
      <div id="optimization-status" class="space-y-2 text-sm">
        <p><strong>How Hide All Works模块:</strong> <span id="module-status"></span></p>
        <p><strong>动态加载:</strong> <span id="dynamic-loading-status"></span></p>
        <p><strong>图片懒加载:</strong> <span id="lazy-loading-status"></span></p>
        <p><strong>动画优化:</strong> <span id="animation-status"></span></p>
        <p><strong>重绘优化:</strong> <span id="repaint-status"></span></p>
      </div>
    </div>
    
    <!-- 性能对比 -->
    <div class="grid md:grid-cols-2 gap-8">
      <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold mb-4">优化前</h3>
        <ul class="space-y-2 text-sm text-red-600">
          <li>• 加载5张高分辨率图片</li>
          <li>• 复杂的网格布局</li>
          <li>• 重型动画效果</li>
          <li>• 大量DOM元素</li>
          <li>• 主线程工作过重</li>
        </ul>
      </div>
      
      <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold mb-4">优化后</h3>
        <ul class="space-y-2 text-sm text-green-600">
          <li>• 桌面端保持完整功能</li>
          <li>• 移动端动态加载简化版本</li>
          <li>• 减少动画复杂度</li>
          <li>• 优化图片加载</li>
          <li>• 减少主线程工作</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="main.js"></script>
  <script>
    // 更新设备信息
    document.getElementById('screen-width').textContent = window.innerWidth + 'px';
    document.getElementById('device-type').textContent = isMobile() ? '移动端' : '桌面端';
    document.getElementById('user-agent').textContent = navigator.userAgent.substring(0, 50) + '...';
    
    // 更新优化状态
    document.getElementById('module-status').textContent = isMobile() ? '动态加载简化版' : '完整版本';
    document.getElementById('dynamic-loading-status').textContent = isMobile() ? '已启用' : '不适用';
    document.getElementById('lazy-loading-status').textContent = '已启用';
    document.getElementById('animation-status').textContent = isMobile() ? '已优化' : '正常';
    document.getElementById('repaint-status').textContent = isMobile() ? '已优化' : '正常';
    
    // 更新性能指标
    setInterval(() => {
      const metricsDiv = document.getElementById('metrics');
      metricsDiv.innerHTML = `
        <p>加载时间: ${performanceMetrics.loadTime ? performanceMetrics.loadTime.toFixed(2) + 'ms' : '计算中...'}</p>
        <p>DOM加载: ${performanceMetrics.domContentLoaded ? performanceMetrics.domContentLoaded.toFixed(2) + 'ms' : '计算中...'}</p>
        <p>首次绘制: ${performanceMetrics.firstPaint ? performanceMetrics.firstPaint.toFixed(2) + 'ms' : '计算中...'}</p>
        <p>内容绘制: ${performanceMetrics.firstContentfulPaint ? performanceMetrics.firstContentfulPaint.toFixed(2) + 'ms' : '计算中...'}</p>
      `;
    }, 1000);
  </script>
</body>
</html> 